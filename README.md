# PUFp-for-OPV-materials  
<img width="1099" height="402" alt="image" src="https://github.com/user-attachments/assets/07800e2b-b8f7-4e0b-bbfa-6c68764ceaea" />

1. The code used for use PUFp as input to training ML models (RF, KRR, SVM) with the attached OPV materials dataset
2. con_smile.py standardizes SMILES.
3. Get polymer-unit.py, polymer-unit-classify. py and the input file (OPV_exp_data.csv) are placed in the same folder.
4. Run get-polymer-unit. py to get the output file as follows (python get-polymer-unit.py):
   1）ring_total_list.csv ：Polymer-units identified from test.csv.
   2）one_hot.csv：One-hot fingerprint for the input file generated by ring_total_list.
   3）number.csv：PUFp for input files generated by ring_total_list (see paper for details).
   4）adjacent_matrix.csv：Adjacency matrix.
   5）node_matrix.csv：Node matrix.
   6）index_data.csv：Polymer-units number for each data.
5. The output file obtained by running polymer-unit-classify. py is as follows（python polymer-unit-classify. py）:
   1）ring_df.csv ：Record the classification label of each polymer-units.
   2）type_frame.csv：Record the polymer-units type contained in each data.
   
## When using PURS in your research PLEASE cite the paper:  
[1] Xinyue Zhang, Ye Sheng, Xiumin Liu, Jiong Yang, William A. Goddard III, Caichao Ye*, Wenqing Zhang*. Polymer-unit Graph: Advancing Interpretability in Graph Neural Network Machine Learning for Organic Polymer Semiconductor Materials. J. Chem. Theory Comput., 2024, 20(7), 2908-2920.  
[2] Xinyue Zhang, Genwang Wei, Ye Sheng, Wenjun Bai, Jiong Yang, Wenqing Zhang*, Caichao Ye*. Polymer-Unit Fingerprint (PUFp): An Accessible Expression of Polymer Organic Semiconductors for Machine Learning. ACS Appl. Mater. Interfaces, 2023, 15(17), 21537–21548.  
[3] Xiumin Liu, Xinyue Zhang, Ye Sheng, Zihe Zhang, Pan Xiong*, Xuehai Ju*, Junwu Zhu, Caichao Ye*. Advancing Organic Photovoltaic Materials by Machine Learning-Driven Design with Polymer-Unit Fingerprints. npj Comput. Mater., 2025, 11, 107.  
[4] Caichao Ye, Tao Feng, Weishu Liu*, Wenqing Zhang*. Functional Unit: A New Perspective on Materials Science Research Paradigms. Acc. Mater. Res., 2025, 6(8), 914-920.  
